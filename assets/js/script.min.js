!function(s){"use strict";var p,r,u="goodpopup",t=".js-goodpopup-inner-content",d="goodpopup_visible",l="goodpopup-inner-content_destroyed",c="goodpopup-inner-content-element_fullwidth",a="goodpopup-inner-content-element_hidden",f="goodpopup-inner-content-element_hiddenfull",g="goodpopup-inner-content-element_pseudohidden",h=!1,C={},O=[],P=0,m=function(){var e,t=document.createElement("div"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",MSTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"};for(e in n)if("undefined"!=typeof t.style[e])return n[e];return!1}(),e=function(){var e,t,n,o=s("<div>").css("position","absolute").css("visibility","hidden").css("width","100px").css("msOverflowStyle","scrollbar");s("body").append(o).promise().done(function(){t=o.outerWidth(),o.css("overflow","scroll"),e=s("<div>").css("width","100%"),o.append(e).promise().done(function(){n=e.innerWidth(),o.remove(),P=t-n})})},I=function(e,t,n){function o(e){"undefined"!=typeof console&&"function"==typeof console.error?console.error(e):alert(e)}switch(t){case"NOT_FOUND":return o("Popup template `"+e+"` doesnâ€™t exist"),e;case"WRONG_OPTIONS":return o("Wrong options object in method `setOptions` on popup `"+e+"`"),n;default:return i="Problem with popup","undefined"!=typeof console&&"function"==typeof console.trace?console.trace(i):alert(i),e}var i},k={createPopupDOM:function(){return s('<div class="goodpopup js-goodpopup"><div class="goodpopup-inner"><div class="goodpopup-inner-content js-goodpopup-inner-content"></div></div></div>').appendTo("body").promise().done(function(){p=s(".js-goodpopup"),r=p.find(t)})},renderPopupContentDOM:function(e,t,n,o){e=s('<div class="goodpopup-inner-content-element  '+(o?c:"")+'" data-popup-id="'+e+'"></div>');return e.append(k.renderPopupContentTemplateDOM(t,n)),e},renderPopupContentTemplateDOM:function(e,t){var n,o,i;if(0<e.filter("script[type='text/x-handlebars-template']").length)"object"==typeof window.Handlebars&&(n=Handlebars.compile(e.html())("object"!=typeof t?{}:t));else{if(i=(o=e.html()).match(/\${([^}]*)}/g))for(var p=0;p<i.length;p++)o=t.hasOwnProperty(i[p].substring(2,i[p].length-1))?o.replace(i[p],t[i[p].substring(2,i[p].length-1)]):o.replace(i[p],"");n=s(o)}return n}},o={handleKeydown:function(e){for(var t=this,n=t.getOptions().keyCodeForClosing,o=0;o<n.length;o++)if(e.keyCode===n[o]){v.close.call(t,t.getOptions().forceClosing.keydown);break}return t},handleOuterClick:function(e){e=s(e.target);return this.getOptions().isOuterClickClosing&&0===e.parents(t).length&&v.close.call(this,this.getOptions().forceClosing.click),this},handleCloseButtonClick:function(){return v.close.call(this,this.getOptions().forceClosing.button),this}},v={open:function(){var n=this;if(h)if(n.isRendered()){if(!n.isHidden())return n;s.each(C,function(e,t){if(t.instance.isRendered()&&!t.instance.isHidden())return v._hide.call(t.instance,function(){n.getOptions().callbackBeforeOpen.call(n),v._show.call(n)}),!1})}else s.each(C,function(e,t){if(t.instance.isRendered()&&!t.instance.isHidden())return v._hide.call(t.instance,function(){n.getOptions().callbackBeforeOpen.call(n),v._renderContent.call(n)}),!1});else n.getOptions().callbackBeforeOpen.call(n),v._renderContent.call(n);return n},close:function(e){var t=this;if(!h||!t.isRendered())return t;e=e||!1;if(0<O.length)if(e){for(var n=O.length;0<n;n--)v._destroyContent.call(O[n-1].instance,!1);v._destroyContent.call(t,!0)}else v._destroyContent.call(t,!1,function(){O[O.length-1].instance.getOptions().callbackBeforeOpen.call(O[O.length-1].instance),v._show.call(O[O.length-1].instance)});else v._destroyContent.call(t,!0);return t},dequeue:function(){return h&&this.isHidden()&&this.isRendered()&&v._destroyContent.call(this,!1),this},_renderContent:function(){var t=this;if(t.isRendered()&&!t.getOptions().isIframe&&!t.getOptions().isPrerendered)return t;var e=function(){var e;s(document).off("keydown."+u).on("keydown."+u,function(e){o.handleKeydown.call(t,e)}),p.off("click."+u).on("click."+u,function(e){o.handleOuterClick.call(t,e)}),t.getOptions().closeButton&&t.getPopupContent().find(t.getOptions().closeButton).off("click."+u).on("click."+u,function(e){o.handleCloseButtonClick.call(t,e)}),h=(h?(m&&C[t.getPopupId()].$popupContent.off(m+".plugin_suffix").on(m+".plugin_suffix",function(e){e.target===C[t.getPopupId()].$popupContent[0]&&(C[t.getPopupId()].$popupContent.off(m+".plugin_suffix"),t.getOptions().callbackAfterOpen.call(t))}),setTimeout(function(){C[t.getPopupId()].$popupContent.removeClass(g)},1)):(e=s("body").width(),s("html").addClass("noscroll"),s("body").width()>e&&(s("html").addClass("noscroll-margin").css("margin-right",parseFloat(s("html").css("margin-right"))+P+"px"),s(".goodpopup-margin-right").each(function(){var e=s(this);e.css("margin-right",parseFloat(e.css("margin-right"))+P+"px")}),s(".goodpopup-margin-left").each(function(){var e=s(this);e.css("margin-left",parseFloat(e.css("margin-left"))-P+"px")})),m&&p.off(m+".plugin_suffix").on(m+".plugin_suffix",function(e){e.target===p[0]&&(p.off(m+".plugin_suffix"),t.getOptions().callbackAfterOpen.call(t))}),p.addClass(d)),m||t.getOptions().callbackAfterOpen.call(t),C[t.getPopupId()].isRendered=!0,!(C[t.getPopupId()].isHidden=!1))};return t.getOptions().isPrerendered||(t.getOptions().isDetachable||t.getOptions().isIframe)&&0!==C[t.getPopupId()].$popupContent.length||(C[t.getPopupId()].$popupContent=s(k.renderPopupContentDOM(t.getPopupId(),t.getTemplate(),t.getOptions().data,t.getOptions().isFullWidth))),h&&C[t.getPopupId()].$popupContent.addClass(g),!t.getOptions().isPrerendered&&!t.getOptions().isIframe||t.getOptions().isIframe&&!t.isRendered()?r.append(C[t.getPopupId()].$popupContent).promise().done(function(){e()}):(t.getOptions().isPrerendered&&t.setOptions({isPrerendered:!1}),C[t.getPopupId()].$popupContent.removeClass(a+" "+f),e()),t},_rerenderContent:function(e){var t=this,n=C[t.getPopupId()].$popupContent;return C[t.getPopupId()].$popupContent=s(k.renderPopupContentDOM(t.getPopupId(),t.getTemplate(),t.getOptions().data,t.getOptions().isFullWidth)),C[t.getPopupId()].$popupContent.addClass(a+" "+f),n.after(C[t.getPopupId()].$popupContent).promise().done(function(){n.remove(),"function"==typeof e&&e()}),t},_destroyContent:function(e,t){var n=this;if(!n.isRendered())return n;n.getOptions().callbackBeforeClose.call(n);for(var o,i=0;i<O.length;i++)if(O[i].instance===n){O.splice(i,1);break}return void 0!==e&&e?(o=function(){n.getOptions().isIframe?(C[n.getPopupId()].$popupContent.addClass(a+" "+f).removeClass(l),C[n.getPopupId()].isHidden=!0):n.getOptions().isDetachable?C[n.getPopupId()].$popupContent.detach().removeClass(a+" "+f+" "+g+" "+l):(C[n.getPopupId()].$popupContent.remove(),C[n.getPopupId()].$popupContent=s()),n.getOptions().callbackAfterClose.call(n)},n.getOptions().closeButton&&n.getPopupContent().find(n.getOptions().closeButton).off("click."+u),p.off("click."+u),s(document).off("keydown."+u),m&&p.off(m+".plugin_suffix").on(m+".plugin_suffix",function(e){e.target===p[0]&&(p.off(m+".plugin_suffix"),o())}),p.removeClass(d),m||o(),s("html").removeClass("noscroll"),s("html").hasClass("noscroll-margin")&&(s("html").css("margin-right",parseFloat(s("html").css("margin-right"))-P+"px").removeClass("noscroll-margin"),s(".goodpopup-margin-right").each(function(){var e=s(this);e.css("margin-right",parseFloat(e.css("margin-right"))-P+"px")}),s(".goodpopup-margin-left").each(function(){var e=s(this);e.css("margin-left",parseFloat(e.css("margin-left"))+P+"px")})),h=!1,C[n.getPopupId()].isHidden=!1,n.getOptions().isIframe||(C[n.getPopupId()].isRendered=!1)):(o=function(){n.getOptions().isIframe?(C[n.getPopupId()].$popupContent.addClass(a+" "+f).removeClass(l),C[n.getPopupId()].isHidden=!0):n.getOptions().isDetachable?C[n.getPopupId()].$popupContent.detach().removeClass(a+" "+f+" "+g+" "+l):(C[n.getPopupId()].$popupContent.remove(),C[n.getPopupId()].$popupContent=s()),n.getOptions().callbackAfterClose.call(n),"function"==typeof t&&t()},C[n.getPopupId()].isHidden?(C[n.getPopupId()].isHidden=!1,n.getOptions().isIframe||(C[n.getPopupId()].isRendered=!1),o()):(m&&C[n.getPopupId()].$popupContent.off(m+".plugin_suffix").on(m+".plugin_suffix",function(e){e.target===C[n.getPopupId()].$popupContent[0]&&(C[n.getPopupId()].$popupContent.off(m+".plugin_suffix"),o())}),C[n.getPopupId()].$popupContent.addClass(l),m||o(),C[n.getPopupId()].isHidden=!1,n.getOptions().isIframe||(C[n.getPopupId()].isRendered=!1))),n},_show:function(){var n=this;if(!n.isHidden())return n;for(var e=0;e<O.length;e++)if(O[e].instance===n){O.splice(e,1);break}function t(){var t=function(){s(document).off("keydown."+u).on("keydown."+u,function(e){o.handleKeydown.call(n,e)}),p.off("click."+u).on("click."+u,function(e){o.handleOuterClick.call(n,e)}),n.getOptions().closeButton&&n.getPopupContent().find(n.getOptions().closeButton).off("click."+u).on("click."+u,function(e){o.handleCloseButtonClick.call(n,e)}),n.getOptions().callbackAfterOpen.call(n)};m&&C[n.getPopupId()].$popupContent.off(m+".plugin_suffix").on(m+".plugin_suffix",function(e){e.target===C[n.getPopupId()].$popupContent[0]&&(C[n.getPopupId()].$popupContent.off(m+".plugin_suffix"),t())}),setTimeout(function(){C[n.getPopupId()].$popupContent.removeClass(f+" "+a)},1),m||t(),C[n.getPopupId()].isHidden=!1}return n.getOptions().isDetachable||n.getOptions().isIframe?t():v._rerenderContent.call(n,function(){t()}),n},_hide:function(e){var t=this;if(t.isHidden())return t;function n(){C[t.getPopupId()].$popupContent.addClass(f),t.getOptions().callbackAfterClose.call(t),"function"==typeof e&&e()}t.getOptions().callbackBeforeClose.call(t),s(document).off("keydown."+u),p.off("click."+u),t.getOptions().closeButton&&t.getPopupContent().find(t.getOptions().closeButton).off("click."+u),m&&C[t.getPopupId()].$popupContent.off(m+".plugin_suffix").on(m+".plugin_suffix",function(e){e.target===C[t.getPopupId()].$popupContent[0]&&(C[t.getPopupId()].$popupContent.off(m+".plugin_suffix"),n())}),C[t.getPopupId()].$popupContent.addClass(a),m||n(),O.push(C[t.getPopupId()]),C[t.getPopupId()].isHidden=!0}},y=function(e,t){var n=this,o=e.attr("id"),i=t;return this.getOptions=function(){return i},this.getPopupId=function(){return o},this.getPopupContent=function(){return C[n.getPopupId()].$popupContent},this.getTemplate=function(){return e},this.isRendered=function(){return C[n.getPopupId()].isRendered},this.isHidden=function(){return C[n.getPopupId()].isHidden},this.setOptions=function(e){return!s.isPlainObject(e)||e.hasOwnProperty("forceClosing")&&!s.isPlainObject(e.forceClosing)?I(o,"WRONG_OPTIONS",e):(e.hasOwnProperty("isFullWidth")&&e.isFullWidth!==n.getOptions().isFullWidth&&n.getPopupContent()&&(e.isFullWidth?C[n.getPopupId()].$popupContent.addClass(c):C[n.getPopupId()].$popupContent.removeClass(c)),e.hasOwnProperty("keyCodeForClosing")&&e.keyCodeForClosing!==n.getOptions().keyCodeForClosing&&"number"==typeof e.keyCodeForClosing&&(e.keyCodeForClosing=[e.keyCodeForClosing]),i=s.extend({},i,e),n)},this.open=function(){return v.open.call(this)},this.close=function(e){return v.close.call(this,e)},this.dequeue=function(){return v.dequeue.call(this)},n.getOptions().isPrerendered&&(C[n.getPopupId()].$popupContent=s(k.renderPopupContentDOM(n.getPopupId(),n.getTemplate(),n.getOptions().data,n.getOptions().isFullWidth)),C[n.getPopupId()].$popupContent.addClass(a+" "+f),r.append(C[n.getPopupId()].$popupContent),C[n.getPopupId()].isRendered=!0,C[n.getPopupId()].isHidden=!0),n.getTemplate().data("goodpopup",n),n};s.goodpopup={getPopup:function(e){if("undefined"!=typeof C[e]&&"undefined"!=typeof C[e].instance)return C[e].instance;if(void 0===e)return!1;var t=s("#"+e);return 0===t.length?I(e,"NOT_FOUND"):(t.goodpopup(),C[e].instance)},getPopups:function(){return C},getQueue:function(){return O},version:"2.0.0-beta.20"},s.fn.goodpopup=function(i){return this.each(function(e,t){var n=s(t),o=n.attr("id"),t="undefined"!=typeof C[o]&&"undefined"!=typeof C[o].instance?C[o].instance:undefined;void 0===t?(C[o]={instance:undefined,isRendered:!1,isHidden:!1,$popupContent:s()},C[o].instance=new y(n,s.extend({},{callbackBeforeOpen:function(){},callbackAfterOpen:function(){},callbackBeforeClose:function(){},callbackAfterClose:function(){},isPrerendered:!1,isIframe:!1,isDetachable:!1,isOuterClickClosing:!0,isFullWidth:!1,keyCodeForClosing:[27],closeButton:"",forceClosing:{click:!0,keydown:!0,button:!1},data:{}},i,n.data()))):t.setOptions.call(t,i)})},s(function(){e(),k.createPopupDOM().done(function(){s("script[type='text/x-handlebars-template']").goodpopup()})})}(jQuery);
//# sourceMappingURL=script.min.js.map